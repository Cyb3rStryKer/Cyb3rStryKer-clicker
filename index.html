<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CyberStryKer-clicker</title>
  <style>
    * {
      box-sizing: border-box;
    }
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Comic Sans MS', cursive;
      background: var(--bg);
      color: var(--text);
      overflow: hidden;
    }

    :root {
      --bg: #fff8e1;
      --panel: #fff3e0;
      --text: #bf360c;
      --accent: #fb8c00;
      --hover: #f57c00;
    }
    .dark {
      --bg: #1e1e1e;
      --panel: #2c2c2c;
      --text: #f5f5f5;
      --accent: #64b5f6;
      --hover: #42a5f5;
    }

    #container {
      display: flex;
      height: 100vh;
      width: 100vw;
    }

    #leftPanel, #rightPanel {
      padding: 20px;
      width: 50%;
      overflow-y: auto;
    }

    #leftPanel {
      background: var(--bg);
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #rightPanel {
      background: var(--panel);
      border-left: 4px solid var(--accent);
    }

    h1 {
      margin-top: 10px;
      font-size: 2em;
      color: var(--accent);
    }

    #creditsDisplay {
      font-size: 1.8em;
      margin: 10px;
      font-weight: bold;
    }

    #clickBagBtn {
      width: 100px;
      height: 100px;
      font-size: 2em;
      background: #d32f2f;
      border: 3px solid #b71c1c;
      border-radius: 50%;
      color: white;
      cursor: pointer;
      box-shadow: 4px 4px 0 #7b0000;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 20px 0;
      transition: transform 0.1s ease;
    }
    #clickBagBtn:active {
      transform: scale(0.9);
    }

    .panelTitle {
      margin-top: 20px;
      font-size: 1.5em;
      text-align: center;
      color: var(--accent);
    }

    button {
      font-size: 1em;
      font-weight: bold;
      margin: 8px 0;
      padding: 10px 15px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      background: var(--accent);
      color: white;
    }

    button:hover {
      background: var(--hover);
    }

    #inventoryModal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: var(--panel);
      padding: 20px;
      border: 3px solid var(--accent);
      border-radius: 12px;
      box-shadow: 0 0 10px #00000066;
      display: none;
      z-index: 10;
      max-height: 80vh;
      overflow-y: auto;
    }

    .inventory-item {
      margin: 5px 0;
      font-size: 1.1em;
    }

    #overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #00000066;
      display: none;
      z-index: 9;
    }

    #settingsPanel {
      position: absolute;
      top: 10px;
      right: 10px;
    }

    #settingsPanel button {
      margin-left: 5px;
    }

    #message {
      min-height: 1.5em;
      margin-top: 10px;
      color: green;
      font-weight: bold;
      text-align: center;
    }
  </style>
</head>
<body>
<div id="container">
  <div id="leftPanel">
    <h1>CyberStryKer-clicker</h1>
    <div id="creditsDisplay">üí∞ Cr√©dits : <span id="creditCount">0</span></div>
    <button id="clickBagBtn">üí∞</button>
    <div id="message"></div>
  </div>
  <div id="rightPanel">
    <h2 class="panelTitle">üì¶ Caisse Myst√®re</h2>
    <button id="buyBoxBtn">Acheter une caisse (10$)</button>

    <h2 class="panelTitle">üöÄ Boosters</h2>
    <div id="boostersContainer"></div>

    <h2 class="panelTitle">üçé Inventaire</h2>
    <button id="toggleInventoryBtn">üì¶ Inventaire</button>
  </div>

  <div id="settingsPanel">
    <button id="toggleThemeBtn">üåô</button>
    <button id="resetBtn">üîÑ</button>
  </div>

  <div id="overlay"></div>
  <div id="inventoryModal"></div>
  <script>
  let credits = 0;
  let clickMultiplier = 1;
  let boxPrice = 10;
  let inventory = {};
  let boosters = [
    { name: "x0.01", price: 20, multiplier: 0.01 },
    { name: "x0.1", price: 100, multiplier: 0.1 },
    { name: "x1", price: 1000, multiplier: 1 }
  ];
  let isDark = false;

  const rarities = {
    "Commun": { chance: 80, boost: 0.01, color: "#8bc34a" },
    "Rare": { chance: 15, boost: 0.1, color: "#2196f3" },
    "√âpique": { chance: 4.5, boost: 0.5, color: "#9c27b0" },
    "Mythique": { chance: 0.4, boost: 1, color: "#ff9800" },
    "L√©gendaire": { chance: 0.1, boost: 10, color: "#f44336" }
  };

  const fruits = ["üçé", "üçå", "üçá", "üçí", "üçç", "ü•ù", "üçâ"];

  function save() {
    localStorage.setItem("clickerSave", JSON.stringify({
      credits, clickMultiplier, boxPrice, inventory, isDark
    }));
  }

  function load() {
    const saveData = JSON.parse(localStorage.getItem("clickerSave"));
    if (saveData) {
      credits = saveData.credits || 0;
      clickMultiplier = saveData.clickMultiplier || 1;
      boxPrice = saveData.boxPrice || 10;
      inventory = saveData.inventory || {};
      isDark = saveData.isDark || false;
      if (isDark) document.body.classList.add("dark");
    }
  }

  function formatNumber(n) {
    if (n >= 1e9) return (n / 1e9).toFixed(1) + "B";
    if (n >= 1e6) return (n / 1e6).toFixed(1) + "M";
    if (n >= 1e3) return (n / 1e3).toFixed(1) + "K";
    return Math.floor(n);
  }

  function updateDisplay() {
    document.getElementById("creditCount").textContent = formatNumber(credits);
    const boostersContainer = document.getElementById("boostersContainer");
    boostersContainer.innerHTML = "";
    boosters.forEach(boost => {
      const btn = document.createElement("button");
      btn.textContent = `${boost.name} - ${boost.price}$`;
      btn.onclick = () => {
        if (credits >= boost.price) {
          credits -= boost.price;
          clickMultiplier += boost.multiplier;
          boost.price = Math.ceil(boost.price * 1.5);
          showMessage(`Boost ${boost.name} achet√© !`);
          updateDisplay();
        }
      };
      boostersContainer.appendChild(btn);
    });
  }

  function showMessage(msg) {
    const el = document.getElementById("message");
    el.textContent = msg;
    setTimeout(() => {
      if (el.textContent === msg) el.textContent = "";
    }, 2000);
  }

  function openInventoryModal() {
    const modal = document.getElementById("inventoryModal");
    const overlay = document.getElementById("overlay");
    modal.innerHTML = "<h3>üéí Inventaire</h3>";
    Object.entries(inventory).forEach(([id, obj]) => {
      const div = document.createElement("div");
      div.className = "inventory-item";
      div.style.color = rarities[obj.rarity].color;
      div.innerHTML = `${obj.emoji} x${obj.qty} ‚Äî ${obj.rarity} (√ó${rarities[obj.rarity].boost})`;
      modal.appendChild(div);
    });
    modal.style.display = "block";
    overlay.style.display = "block";
    overlay.onclick = closeInventory;
  }

  function closeInventory() {
    document.getElementById("inventoryModal").style.display = "none";
    document.getElementById("overlay").style.display = "none";
  }

  function addCredits() {
    credits += clickMultiplier;
    updateDisplay();
  }

  function buyBox() {
    if (credits < boxPrice) {
      showMessage("Pas assez de cr√©dits !");
      return;
    }

    credits -= boxPrice;
    boxPrice = Math.floor(boxPrice * 1.1 + 1);

    // Gagner un fruit selon les probabilit√©s
    const rand = Math.random() * 100;
    let sum = 0;
    let rarity = "Commun";
    for (const key in rarities) {
      sum += rarities[key].chance;
      if (rand <= sum) {
        rarity = key;
        break;
      }
    }

    const emoji = fruits[Math.floor(Math.random() * fruits.length)];
    const fruitId = emoji + " " + rarity;

    if (!inventory[fruitId]) {
      inventory[fruitId] = {
        emoji,
        rarity,
        qty: 0
      };
    }
    inventory[fruitId].qty++;
    clickMultiplier += rarities[rarity].boost;

    showMessage(`Gagn√© : ${emoji} ${rarity} !`);
    updateDisplay();
  }

  function resetGame() {
    const confirm1 = confirm("‚ö†Ô∏è R√©initialiser toute votre progression ?");
    if (!confirm1) return;
    const confirm2 = confirm("√ätes-vous s√ªr de vouloir tout perdre ?");
    if (!confirm2) return;

    credits = 0;
    clickMultiplier = 1;
    boxPrice = 10;
    inventory = {};
    localStorage.removeItem("clickerSave");
    showMessage("Jeu r√©initialis√© !");
    updateDisplay();
  }

  function toggleTheme() {
    isDark = !isDark;
    document.body.classList.toggle("dark");
    save();
  }

  // √âv√©nements
  document.getElementById("clickBagBtn").onclick = addCredits;
  document.getElementById("buyBoxBtn").onclick = buyBox;
  document.getElementById("toggleInventoryBtn").onclick = () =>
    document.getElementById("inventoryModal").style.display === "block"
      ? closeInventory()
      : openInventoryModal();
  document.getElementById("resetBtn").onclick = resetGame;
  document.getElementById("toggleThemeBtn").onclick = toggleTheme;

  // Initialisation
  load();
  updateDisplay();
  setInterval(save, 5000); // sauvegarde auto

</script>
</body>
</html>
