<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CyberStryKer-clicker</title>
<style>
  /* --- Base style --- */
  body {
    margin: 0;
    font-family: 'Comic Sans MS', cursive, sans-serif;
    background: #fff8e1;
    color: #bf360c;
    -webkit-font-smoothing: antialiased;
    user-select: none;
  }
  #container {
    display: flex;
    height: 100vh;
    padding: 20px;
    box-sizing: border-box;
  }

  /* --- Left Panel (click + level) --- */
  #leftPanel {
    width: 50%;
    padding: 20px;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  /* --- Right Panel (inventory + boosters + caisse) --- */
  #rightPanel {
    width: 50%;
    padding: 20px;
    box-sizing: border-box;
    background: #fff3e0;
    border-left: 5px solid #fb8c00;
    overflow-y: auto;
  }

  /* --- Titles --- */
  h1, h2 {
    text-align: center;
    color: #bf360c;
    text-shadow: 1px 1px 0 #f57c00;
    margin: 0 0 20px 0;
  }

  /* --- Credits display --- */
  #creditsDisplay {
    font-size: 2.5em;
    font-weight: 900;
    text-align: center;
    margin: 10px 0 30px 0;
    padding: 15px 30px;
    background: #ffe0b2;
    border: 4px solid #fb8c00;
    border-radius: 30px;
    box-shadow: 4px 4px 0 #bf360c;
    width: fit-content;
    min-width: 200px;
  }

  /* --- Sac bouton rond rouge avec emoji argent --- */
  #clickBagBtn {
    font-size: 3em;
    width: 110px;
    height: 110px;
    background-color: #d32f2f;
    border: 4px solid #b71c1c;
    border-radius: 50%;
    color: white;
    cursor: pointer;
    box-shadow: 6px 6px 0 #7b0000;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 30px;
    transition: background-color 0.2s, transform 0.15s;
  }
  #clickBagBtn:hover {
    background-color: #b71c1c;
  }
  #clickBagBtn:active {
    transform: scale(0.9);
  }

  /* --- Animation "pop" cartoon --- */
  .pop {
    animation: popAnim 0.3s forwards;
  }
  @keyframes popAnim {
    0% { transform: scale(1); }
    50% { transform: scale(1.3); }
    100% { transform: scale(1); }
  }

  /* --- Level & XP --- */
  #levelContainer {
    font-weight: 900;
    font-size: 1.7em;
    margin-bottom: 10px;
    text-align: center;
    user-select: none;
  }
  #xpBarBackground {
    width: 90%;
    height: 32px;
    background: #fff3e0;
    border: 4px solid #fb8c00;
    border-radius: 16px;
    position: relative;
    margin-bottom: 40px;
    box-shadow: inset 0 0 10px #f57c00;
  }
  #xpBarFill {
    height: 100%;
    background: linear-gradient(90deg, #f57c00, #fb8c00);
    border-radius: 16px 0 0 16px;
    transition: width 0.3s ease;
    box-shadow: 0 0 8px #fb8c00;
  }
  #xpText {
    position: absolute;
    top: 4px;
    width: 100%;
    text-align: center;
    font-weight: 900;
    color: #bf360c;
    text-shadow: 1px 1px 0 #fff3e0;
  }

  /* --- Message --- */
  #message {
    text-align: center;
    font-weight: 700;
    font-size: 1.3em;
    min-height: 36px;
    margin-top: 15px;
    color: #4a4a4a;
    user-select: none;
  }

  /* --- Inventaire --- */
  #inventoryList {
    margin-bottom: 25px;
  }
  .inventory-item {
    display: flex;
    align-items: center;
    background: #fff8e1;
    border: 3px solid #fb8c00;
    border-radius: 25px;
    padding: 10px 22px;
    font-weight: 900;
    box-shadow: 4px 4px 0 #bf360c;
    color: #bf360c;
    gap: 15px;
    margin-bottom: 12px;
    text-shadow: 1px 1px 0 #f57c00;
    font-size: 1.2em;
    user-select: none;
  }
  .inventory-item img {
    width: 52px;
    height: 52px;
    filter: drop-shadow(1px 1px 1px #bf360c);
  }

  /* --- Boosters --- */
  #boostersContainer button {
    display: block;
    width: 100%;
    margin-bottom: 12px;
    font-weight: 900;
    font-size: 1.2em;
    background: #ffcc80;
    border: 4px solid #fb8c00;
    border-radius: 20px;
    cursor: pointer;
    box-shadow: 4px 4px 0 #bf360c;
    color: #bf360c;
    padding: 14px 0;
    transition: background-color 0.3s, transform 0.15s;
    user-select: none;
  }
  #boostersContainer button:hover {
    background: #f57c00;
    color: white;
  }
  #boostersContainer button:active {
    transform: scale(0.95);
  }

  /* --- Caisse myst√®re --- */
  #buyBoxBtn {
    display: block;
    width: 100%;
    font-weight: 900;
    font-size: 1.4em;
    background: #ffcc80;
    border: 4px solid #fb8c00;
    border-radius: 25px;
    cursor: pointer;
    box-shadow: 4px 4px 0 #bf360c;
    color: #bf360c;
    padding: 18px 0;
    margin-top: 25px;
    transition: background-color 0.3s, transform 0.15s;
    user-select: none;
  }
  #buyBoxBtn:hover {
    background: #f57c00;
    color: white;
  }
  #buyBoxBtn:active {
    transform: scale(0.95);
  }

  /* --- Scroll barre droite --- */
  #rightPanel {
    scrollbar-width: thin;
    scrollbar-color: #f57c00 #ffe0b2;
  }
  #rightPanel::-webkit-scrollbar {
    width: 12px;
  }
  #rightPanel::-webkit-scrollbar-track {
    background: #ffe0b2;
  }
  #rightPanel::-webkit-scrollbar-thumb {
    background-color: #f57c00;
    border-radius: 20px;
    border: 4px solid #ffe0b2;
  }
</style>
</head>
<body>

<div id="container">
  <div id="leftPanel">
    <h1>CyberStryKer-clicker</h1>
    <div id="creditsDisplay">0 $</div>
    <button id="clickBagBtn" title="Cliquez pour gagner 1 dollar !">üí∞</button>

    <div id="levelContainer">
      <div>Niveau :</div>
      <div id="levelDisplay">1</div>
    </div>
    <div id="xpBarBackground">
      <div id="xpBarFill"></div>
      <div id="xpText">0 / 100</div>
    </div>

    <div id="message"></div>
  </div>

  <div id="rightPanel">
    <h2>Inventaire</h2>
    <div id="inventoryList">Inventaire vide</div>

    <h2>Boosters</h2>
    <div id="boostersContainer"></div>

    <h2>Bo√Æte Myst√®re</h2>
    <button id="buyBoxBtn" title="Acheter une caisse myst√®re pour 20 $">Acheter caisse - 20 $</button>
  </div>
</div>

<script>
  // --- Variables Globales ---
  let credits = 0;
  let level = 1;
  let xp = 0;
  let xpForNextLevel = 100;
  let clickValue = 1;
  let boosters = [
    { name: "Multiplicateur x2", price: 50, multiplier: 2, owned: 0 },
    { name: "Multiplicateur x5", price: 300, multiplier: 5, owned: 0 },
    { name: "Multiplicateur x10", price: 1500, multiplier: 10, owned: 0 }
  ];

  // Fruits (objets de caisse) avec raret√©s
  const fruits = [
    { name: "Pomme üçé", rarity: "Commun", value: 3, sound: "pop" },
    { name: "Banane üçå", rarity: "Commun", value: 4, sound: "pop" },
    { name: "Cerise üçí", rarity: "Rare", value: 10, sound: "sparkle" },
    { name: "Ananas üçç", rarity: "Rare", value: 12, sound: "sparkle" },
    { name: "Kiwi ü•ù", rarity: "Tr√®s Rare", value: 25, sound: "shimmer" },
    { name: "Melon üçà", rarity: "Tr√®s Rare", value: 30, sound: "shimmer" }
  ];

  // Inventaire (fruits collect√©s)
  const inventory = {};

  // Sons (utilisation de Web Audio API simple)
  const sounds = {
    pop: new Audio('https://actions.google.com/sounds/v1/cartoon/pop.ogg'),
    sparkle: new Audio('https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg'),
    shimmer: new Audio('https://actions.google.com/sounds/v1/cartoon/slide_whistle_to_drum_hit.ogg'),
    click: new Audio('https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg'),
    error: new Audio('https://actions.google.com/sounds/v1/cartoon/cartoon_boing.ogg'),
    cash: new Audio('https://actions.google.com/sounds/v1/cash_register/cash_register.ogg'),
  };

  // --- √âl√©ments DOM ---
  const creditsDisplay = document.getElementById('creditsDisplay');
  const clickBagBtn = document.getElementById('clickBagBtn');
  const message = document.getElementById('message');
  const inventoryList = document.getElementById('inventoryList');
  const boostersContainer = document.getElementById('boostersContainer');
  const buyBoxBtn = document.getElementById('buyBoxBtn');
  const levelDisplay = document.getElementById('levelDisplay');
  const xpBarFill = document.getElementById('xpBarFill');
  const xpText = document.getElementById('xpText');

  // --- Fonctions ---

  // Calcul du multiplicateur total des boosters
  function getTotalMultiplier() {
    return boosters.reduce((total, b) => total * (b.owned > 0 ? b.multiplier : 1), 1);
  }

  // Mise √† jour affichage cr√©dits
  function updateCreditsDisplay() {
    creditsDisplay.textContent = `${credits} $`;
  }

  // Mise √† jour inventaire affich√©
  function updateInventoryDisplay() {
    if (Object.keys(inventory).length === 0) {
      inventoryList.textContent = "Inventaire vide";
      return;
    }
    inventoryList.innerHTML = "";
    for (const [fruitName, count] of Object.entries(inventory)) {
      const fruit = fruits.find(f => f.name === fruitName);
      if (!fruit) continue;
      const div = document.createElement("div");
      div.className = "inventory-item";
      div.innerHTML = `<img src="https://twemoji.maxcdn.com/v/latest/svg/${fruitNameToCode(fruit.name)}.svg" alt="${fruit.name}"> ${fruit.name} x${count}`;
      inventoryList.appendChild(div);
    }
  }

  // Convert emoji fruit name to twemoji code for img src
  function fruitNameToCode(name) {
    // Map emoji characters to codes manually since direct conversion is tricky
    switch (name) {
      case "Pomme üçé": return "1f34e";  // red apple
      case "Banane üçå": return "1f34c"; // banana
      case "Cerise üçí": return "1f352";  // cherries
      case "Ananas üçç": return "1f34d";  // pineapple
      case "Kiwi ü•ù": return "1f95d";  // kiwi fruit
      case "Melon üçà": return "1f348";  // melon
      default: return "1f34e"; // fallback apple
    }
  }

  // Ajout de cr√©dits lors du clic
  function clickBag() {
    const gained = clickValue * getTotalMultiplier();
    credits += gained;
    updateCreditsDisplay();
    playSound("click");
    clickBagBtn.classList.add("pop");
    setTimeout(() => clickBagBtn.classList.remove("pop"), 300);
    addXP(10);  // 10 XP par clic
  }

  // Ajout XP et mont√©e de niveau
  function addXP(amount) {
    xp += amount;
    if (xp >= xpForNextLevel) {
      levelUp();
    }
    updateXPDisplay();
  }

  // Affichage de la barre XP
  function updateXPDisplay() {
    if (xp > xpForNextLevel) xp = xpForNextLevel;
    const percent = (xp / xpForNextLevel) * 100;
    xpBarFill.style.width = percent + "%";
    xpText.textContent = `${xp} / ${xpForNextLevel}`;
    levelDisplay.textContent = level;
  }

  // Passage niveau sup√©rieur
  function levelUp() {
    xp -= xpForNextLevel;
    level++;
    xpForNextLevel = Math.floor(xpForNextLevel * 1.5);
    message.textContent = `Bravo ! Niveau ${level} atteint !`;
    playSound("cash");
    updateXPDisplay();
  }

  // Jouer son simple
  function playSound(name) {
    if (!sounds[name]) return;
    sounds[name].currentTime = 0;
    sounds[name].play();
  }

  // Acheter booster
  function buyBooster(index) {
    const booster = boosters[index];
    if (credits >= booster.price) {
      credits -= booster.price;
      booster.owned++;
      booster.price = Math.floor(booster.price * 1.8);
      clickValue = 1; // reset clickValue base
      boosters.forEach(b => {
        if (b.owned > 0) clickValue *= b.multiplier;
      });
      updateCreditsDisplay();
      renderBoosters();
      updateMessage(`Boosteur "${booster.name}" achet√© !`);
      playSound("cash");
    } else {
      updateMessage(`Pas assez de cr√©dits pour "${booster.name}" !`);
      playSound("error");
    }
  }

  // Afficher message temporaire
  function updateMessage(text) {
    message.textContent = text;
    setTimeout(() => {
      if (message.textContent === text) message.textContent = "";
    }, 3500);
  }

  // Afficher boosters et prix
  function renderBoosters() {
    boostersContainer.innerHTML = "";
    boosters.forEach((b, i) => {
      const btn = document.createElement("button");
      btn.textContent = `${b.name} - Prix: ${b.price} $ (x${b.multiplier}) - Poss√©d√©s: ${b.owned}`;
      btn.addEventListener("click", () => buyBooster(i));
      boostersContainer.appendChild(btn);
    });
  }

  // Acheter une caisse myst√®re
  function buyMysteryBox() {
    const boxPrice = 20;
    if (credits < boxPrice) {
      updateMessage("Pas assez de cr√©dits pour acheter une caisse !");
      playSound("error");
      return;
    }
    credits -= boxPrice;
    updateCreditsDisplay();

    // Tirage al√©atoire pond√©r√© selon raret√©
    const weightedFruits = [];
    fruits.forEach(fruit => {
      let weight = 1;
      if (fruit.rarity === "Commun") weight = 5;
      else if (fruit.rarity === "Rare") weight = 3;
      else if (fruit.rarity === "Tr√®s Rare") weight = 1;
      for (let i = 0; i < weight; i++) weightedFruits.push(fruit);
    });
    const picked = weightedFruits[Math.floor(Math.random() * weightedFruits.length)];

    // Ajouter au stock
    inventory[picked.name] = (inventory[picked.name] || 0) + 1;
    updateInventoryDisplay();

    // Message et son selon raret√©
    updateMessage(`Vous avez re√ßu : ${picked.name} (${picked.rarity}) ! +${picked.value} $`);
    playSound(picked.sound);

    // Ajouter cr√©dit (valeur fruit)
    credits += picked.value;
    updateCreditsDisplay();
  }

  // Initialisation
  function init() {
    updateCreditsDisplay();
    updateXPDisplay();
    renderBoosters();
    updateInventoryDisplay();

    // Event listeners
    clickBagBtn.addEventListener("click", clickBag);
    buyBoxBtn.addEventListener("click", buyMysteryBox);
  }

  init();
</script>
</body>
</html>
