<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CyberStryKer-clicker</title>
<style>
  /* --- Base style --- */
  body {
    margin: 0;
    font-family: 'Comic Sans MS', cursive, sans-serif;
    background: #fff8e1;
    color: #bf360c;
    -webkit-font-smoothing: antialiased;
    user-select: none;
  }
  #container {
    display: flex;
    height: 100vh;
    padding: 20px;
    box-sizing: border-box;
  }

  /* --- Left Panel (click + level) --- */
  #leftPanel {
    width: 50%;
    padding: 20px;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  /* --- Right Panel (inventory + boosters + caisse) --- */
  #rightPanel {
    width: 50%;
    padding: 20px;
    box-sizing: border-box;
    background: #fff3e0;
    border-left: 5px solid #fb8c00;
    overflow-y: auto;
  }

  /* --- Titles --- */
  h1, h2 {
    text-align: center;
    color: #bf360c;
    text-shadow: 1px 1px 0 #f57c00;
    margin: 0 0 20px 0;
  }

  /* --- Credits display --- */
  #creditsDisplay {
    font-size: 2.5em;
    font-weight: 900;
    text-align: center;
    margin: 10px 0 30px 0;
    padding: 15px 30px;
    background: #ffe0b2;
    border: 4px solid #fb8c00;
    border-radius: 30px;
    box-shadow: 4px 4px 0 #bf360c;
    width: fit-content;
    min-width: 200px;
  }

  /* --- Sac bouton rond rouge avec emoji argent --- */
  #clickBagBtn {
    font-size: 3em;
    width: 110px;
    height: 110px;
    background-color: #d32f2f;
    border: 4px solid #b71c1c;
    border-radius: 50%;
    color: white;
    cursor: pointer;
    box-shadow: 6px 6px 0 #7b0000;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 30px;
    transition: background-color 0.2s, transform 0.15s;
    /* On s'assure que c'est bien un cercle parfait */
    aspect-ratio: 1 / 1;
  }
  #clickBagBtn:hover {
    background-color: #b71c1c;
  }
  #clickBagBtn:active {
    transform: scale(0.9);
  }

  /* --- Animation "pop" cartoon --- */
  .pop {
    animation: popAnim 0.3s forwards;
  }
  @keyframes popAnim {
    0% { transform: scale(1); }
    50% { transform: scale(1.3); }
    100% { transform: scale(1); }
  }

  /* --- Level & XP --- */
  #levelContainer {
    font-weight: 900;
    font-size: 1.7em;
    margin-bottom: 10px;
    text-align: center;
    user-select: none;
  }
  #xpBarBackground {
    width: 90%;
    height: 32px;
    background: #fff3e0;
    border: 4px solid #fb8c00;
    border-radius: 16px;
    position: relative;
    margin-bottom: 40px;
    box-shadow: inset 0 0 10px #f57c00;
  }
  #xpBarFill {
    height: 100%;
    background: linear-gradient(90deg, #f57c00, #fb8c00);
    border-radius: 16px 0 0 16px;
    transition: width 0.3s ease;
    box-shadow: 0 0 8px #fb8c00;
  }
  #xpText {
    position: absolute;
    top: 4px;
    width: 100%;
    text-align: center;
    font-weight: 900;
    color: #bf360c;
    text-shadow: 1px 1px 0 #fff3e0;
  }

  /* --- Message --- */
  #message {
    text-align: center;
    font-weight: 700;
    font-size: 1.3em;
    min-height: 36px;
    margin-top: 15px;
    color: #4a4a4a;
    user-select: none;
  }

  /* --- Inventaire --- */
  #inventoryList {
    margin-bottom: 25px;
  }
  .inventory-item {
    display: flex;
    align-items: center;
    background: #fff8e1;
    border: 3px solid #fb8c00;
    border-radius: 25px;
    padding: 10px 22px;
    font-weight: 900;
    box-shadow: 4px 4px 0 #bf360c;
    color: #bf360c;
    gap: 15px;
    margin-bottom: 12px;
    text-shadow: 1px 1px 0 #f57c00;
    font-size: 1.2em;
    user-select: none;
  }
  .inventory-item img {
    width: 52px;
    height: 52px;
    filter: drop-shadow(1px 1px 1px #bf360c);
  }

  /* --- Boosters --- */
  #boostersContainer button {
    display: block;
    width: 100%;
    margin-bottom: 12px;
    font-weight: 900;
    font-size: 1.2em;
    background: #ffcc80;
    border: 4px solid #fb8c00;
    border-radius: 20px;
    cursor: pointer;
    box-shadow: 4px 4px 0 #bf360c;
    color: #bf360c;
    padding: 14px 0;
    transition: background-color 0.3s, transform 0.15s;
    user-select: none;
  }
  #boostersContainer button:hover {
    background: #f57c00;
    color: white;
  }
  #boostersContainer button:active {
    transform: scale(0.95);
  }

  /* --- Caisse myst√®re --- */
  #buyBoxBtn {
    display: block;
    width: 100%;
    font-weight: 900;
    font-size: 1.4em;
    background: #ffcc80;
    border: 4px solid #fb8c00;
    border-radius: 25px;
    cursor: pointer;
    box-shadow: 4px 4px 0 #bf360c;
    color: #bf360c;
    padding: 18px 0;
    margin-top: 25px;
    transition: background-color 0.3s, transform 0.15s;
    user-select: none;
  }
  #buyBoxBtn:hover {
    background: #f57c00;
    color: white;
  }
  #buyBoxBtn:active {
    transform: scale(0.95);
  }

  /* --- Scroll barre droite --- */
  #rightPanel {
    scrollbar-width: thin;
    scrollbar-color: #f57c00 #ffe0b2;
  }
  #rightPanel::-webkit-scrollbar {
    width: 12px;
  }
  #rightPanel::-webkit-scrollbar-track {
    background: #ffe0b2;
  }
  #rightPanel::-webkit-scrollbar-thumb {
    background-color: #f57c00;
    border-radius: 20px;
    border: 4px solid #ffe0b2;
  }
</style>
</head>
<body>

<div id="container">
  <div id="leftPanel">
    <h1>CyberStryKer-clicker</h1>
    <div id="creditsDisplay">0 $</div>
    <button id="clickBagBtn" title="Cliquez pour gagner 1 dollar !">üí∞</button>

    <div id="levelContainer">
      <div>Niveau :</div>
      <div id="levelDisplay">1</div>
    </div>
    <div id="xpBarBackground">
      <div id="xpBarFill"></div>
      <div id="xpText">0 / 100</div>
    </div>

    <div id="message"></div>
  </div>

  <div id="rightPanel">
    <h2>Inventaire</h2>
    <div id="inventoryList">Inventaire vide</div>

    <h2>Boosters</h2>
    <div id="boostersContainer"></div>

    <h2>Bo√Æte Myst√®re</h2>
    <button id="buyBoxBtn" title="Acheter une caisse myst√®re pour 20 $">Acheter caisse - 20 $</button>
  </div>
</div>

<script>
  // --- Variables Globales ---
  let credits = 0;
  let level = 1;
  let xp = 0;
  let xpForNextLevel = 100;
  let clickValue = 1;
  let boosters = [
    { name: "Multiplicateur x2", price: 50, multiplier: 2, owned: 0 },
    { name: "Multiplicateur x5", price: 300, multiplier: 5, owned: 0 },
    { name: "Multiplicateur x10", price: 1500, multiplier: 10, owned: 0 }
  ];

  // Fruits (objets de caisse) avec raret√©s, ajout des Mythiques et L√©gendaires
  const fruits = [
    { name: "Pomme üçé", rarity: "Commun", value: 3, sound: "pop" },
    { name: "Banane üçå", rarity: "Commun", value: 4, sound: "pop" },
    { name: "Cerise üçí", rarity: "Rare", value: 10, sound: "sparkle" },
    { name: "Ananas üçç", rarity: "Rare", value: 12, sound: "sparkle" },
    { name: "Kiwi ü•ù", rarity: "Tr√®s Rare", value: 25, sound: "shimmer" },
    { name: "Melon üçà", rarity: "Tr√®s Rare", value: 30, sound: "shimmer" },
    // Fruits Mythiques
    { name: "Fraise Mythique üçì", rarity: "Mythique", value: 60, sound: "sparkle" },
    { name: "Fruit du Dragon üêâ", rarity: "Mythique", value: 75, sound: "shimmer" },
    // Fruits L√©gendaires
    { name: "Pomme d'Or ‚ú®", rarity: "L√©gendaire", value: 120, sound: "shimmer" },
    { name: "Citrouille Fant√¥me üéÉ", rarity: "L√©gendaire", value: 150, sound: "sparkle" }
  ];

  // Inventaire (fruits collect√©s)
  const inventory = {};

  // Sons (utilisation de Web Audio API simple)
  const sounds = {
    pop: new Audio('https://actions.google.com/sounds/v1/cartoon/pop.ogg'),
    sparkle: new Audio('https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg'),
    shimmer: new Audio('https://actions.google.com/sounds/v1/cartoon/slide_whistle_to_drum_hit.ogg'),
    click: new Audio('https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg')
  };

  // --- √âl√©ments du DOM ---
  const creditsDisplay = document.getElementById('creditsDisplay');
  const clickBagBtn = document.getElementById('clickBagBtn');
  const inventoryList = document.getElementById('inventoryList');
  const boostersContainer = document.getElementById('boostersContainer');
  const levelDisplay = document.getElementById('levelDisplay');
  const xpBarFill = document.getElementById('xpBarFill');
  const xpText = document.getElementById('xpText');
  const message = document.getElementById('message');
  const buyBoxBtn = document.getElementById('buyBoxBtn');

  // --- Fonctions ---
  function updateCreditsDisplay() {
    creditsDisplay.textContent = `${credits} $`;
  }

  function addXp(amount) {
    xp += amount;
    if (xp >= xpForNextLevel) {
      levelUp();
    }
    updateXpBar();
  }

  function levelUp() {
    level++;
    xp -= xpForNextLevel;
    xpForNextLevel = Math.floor(xpForNextLevel * 1.5);
    clickValue += 1;
    showMessage(`Niveau ${level} atteint ! Click +1`);
    updateLevelDisplay();
    updateXpBar();
  }

  function updateLevelDisplay() {
    levelDisplay.textContent = level;
  }

  function updateXpBar() {
    const ratio = xp / xpForNextLevel;
    xpBarFill.style.width = `${Math.min(100, ratio * 100)}%`;
    xpText.textContent = `${xp} / ${xpForNextLevel}`;
  }

  function showMessage(text) {
    message.textContent = text;
    setTimeout(() => {
      if (message.textContent === text) message.textContent = "";
    }, 3000);
  }

  function playSound(name) {
    if (sounds[name]) {
      sounds[name].currentTime = 0;
      sounds[name].play();
    }
  }

  function updateInventoryDisplay() {
    if (Object.keys(inventory).length === 0) {
      inventoryList.textContent = 'Inventaire vide';
      return;
    }
    inventoryList.innerHTML = '';
    for (const fruitName in inventory) {
      const fruitData = fruits.find(f => f.name === fruitName);
      const count = inventory[fruitName];
      const div = document.createElement('div');
      div.className = 'inventory-item';
      div.textContent = `${fruitName} x${count} (${fruitData.rarity})`;
      inventoryList.appendChild(div);
    }
  }

  function getTotalMultiplier() {
    let total = 1;
    boosters.forEach(b => {
      if (b.owned > 0) {
        total *= b.multiplier;
      }
    });
    return total;
  }

  // --- √âv√©nements ---
  clickBagBtn.addEventListener('click', () => {
    const multiplier = getTotalMultiplier();
    const earned = clickValue * multiplier;
    credits += earned;
    updateCreditsDisplay();
    addXp(earned);
    playSound('click');
    clickBagBtn.classList.add('pop');
    setTimeout(() => clickBagBtn.classList.remove('pop'), 300);
  });

  // Affichage boosters + achat
  function renderBoosters() {
    boostersContainer.innerHTML = '';
    boosters.forEach((b, i) => {
      const btn = document.createElement('button');
      btn.textContent = `${b.name} - Prix: ${b.price} $ (x${b.multiplier}) - Poss√©d√©: ${b.owned}`;
      btn.disabled = credits < b.price;
      btn.addEventListener('click', () => {
        if (credits >= b.price) {
          credits -= b.price;
          b.owned++;
          b.price = Math.floor(b.price * 2.2); // Prix augmente √† chaque achat
          updateCreditsDisplay();
          renderBoosters();
          showMessage(`Vous avez achet√© ${b.name} !`);
        }
      });
      boostersContainer.appendChild(btn);
    });
  }

  renderBoosters();

  // --- Caisse myst√®re ---
  buyBoxBtn.addEventListener('click', () => {
    if (credits < 20) {
      showMessage("Pas assez d'argent pour acheter la caisse !");
      return;
    }
    credits -= 20;
    updateCreditsDisplay();

    // Tirage au sort pond√©r√© selon raret√© (plus rare, plus faible chance)
    // Raret√©s pond√©r√©es en %
    const rarityWeights = {
      "Commun": 50,
      "Rare": 25,
      "Tr√®s Rare": 15,
      "Mythique": 7,
      "L√©gendaire": 3
    };

    // G√©n√©rer un pool de fruits selon la pond√©ration raret√©
    const weightedFruits = [];
    fruits.forEach(fruit => {
      const weight = rarityWeights[fruit.rarity] || 0;
      for (let i = 0; i < weight; i++) {
        weightedFruits.push(fruit);
      }
    });

    // Tirer un fruit al√©atoire
    const randomIndex = Math.floor(Math.random() * weightedFruits.length);
    const fruitWon = weightedFruits[randomIndex];

    // Ajouter au stock
    inventory[fruitWon.name] = (inventory[fruitWon.name] || 0) + 1;

    // Ajouter valeur au cr√©dits + xp bonus
    credits += fruitWon.value;
    addXp(Math.floor(fruitWon.value / 2));

    // Jouer son associ√©
    playSound(fruitWon.sound);

    updateCreditsDisplay();
    updateInventoryDisplay();

    showMessage(`Vous avez obtenu: ${fruitWon.name} (${fruitWon.rarity}) +${fruitWon.value} $`);
  });

  // Initialisation affichages
  updateCreditsDisplay();
  updateInventoryDisplay();
  updateLevelDisplay();
  updateXpBar();
</script>

</body>
</html>
